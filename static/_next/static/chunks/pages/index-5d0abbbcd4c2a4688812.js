(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8482:function(e,t,r){"use strict";r.d(t,{E:function(){return f}});var n=r(63),i=r(3105),o=r(5505),a=r(3808),s=r(7294),c=r(8327);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function l(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}var d=s.forwardRef(((e,t)=>{var{htmlWidth:r,htmlHeight:n,alt:i}=e,o=l(e,["htmlWidth","htmlHeight","alt"]);return s.createElement("img",u({width:r,height:n,ref:t,alt:i},o))})),f=(0,n.G)(((e,t)=>{var{fallbackSrc:r,fallback:n,src:a,align:f,fit:h,loading:v,ignoreFallback:p,crossOrigin:m}=e,g=l(e,["fallbackSrc","fallback","src","align","fit","loading","ignoreFallback","crossOrigin"]),y=null!=v||p,b=function(e){var{src:t,srcSet:r,onLoad:n,onError:i,crossOrigin:o,sizes:a,ignoreFallback:u}=e,[l,d]=(0,s.useState)("pending");(0,s.useEffect)((()=>{d(t?"loading":"pending")}),[t]);var f=(0,s.useRef)(),h=(0,s.useCallback)((()=>{if(t){v();var e=new Image;e.src=t,o&&(e.crossOrigin=o),r&&(e.srcset=r),a&&(e.sizes=a),e.onload=e=>{v(),d("loaded"),null==n||n(e)},e.onerror=e=>{v(),d("failed"),null==i||i(e)},f.current=e}}),[t,o,r,a,n,i]),v=()=>{f.current&&(f.current.onload=null,f.current.onerror=null,f.current=null)};return(0,c.G)((()=>{if(!u)return"loading"===l&&h(),()=>{v()}}),[l,h,u]),u?"loaded":l}(u({},e,{ignoreFallback:y})),S=u({ref:t,objectFit:h,objectPosition:f},y?g:(0,o.CE)(g,["onError","onLoad"]));return"loaded"!==b?n||s.createElement(i.m$.img,u({as:d,className:"chakra-image__placeholder",src:r},S)):s.createElement(i.m$.img,u({as:d,src:a,crossOrigin:m,loading:v,className:"chakra-image"},S))}));a.Ts&&(f.displayName="Image")},8344:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return C}});var n=r(5893),i=r(809),o=r.n(i);function a(e,t,r,n,i,o,a){try{var s=e[o](a),c=s.value}catch(u){return void r(u)}s.done?t(c):Promise.resolve(c).then(n,i)}function s(e){return function(){var t=this,r=arguments;return new Promise((function(n,i){var o=e.apply(t,r);function s(e){a(o,n,i,s,c,"next",e)}function c(e){a(o,n,i,s,c,"throw",e)}s(void 0)}))}}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(c){i=!0,o=c}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}}(e,t)||function(e,t){if(e){if("string"===typeof e)return c(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var l=r(63),d=r(3808),f=r(7294),h=r(8101);function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var p=(0,l.G)(((e,t)=>{var{icon:r,children:n,isRound:i,"aria-label":o}=e,a=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,["icon","children","isRound","aria-label"]),s=r||n,c=f.isValidElement(s)?f.cloneElement(s,{"aria-hidden":!0,focusable:!1}):null;return f.createElement(h.z,v({padding:"0",borderRadius:i?"full":void 0,ref:t,"aria-label":o},a),c)}));d.Ts&&(p.displayName="IconButton");var m=r(51),g=r(8017),y=r(8482),b=function(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a};var S=function(e,t){void 0===e&&(e=!1);var r=b((0,f.useState)(e),2),n=r[0],i=r[1];return[n,(0,f.useMemo)((function(){var r=void 0===t?!e:t;return{toggle:function(t){i(void 0===t?function(t){return t===e?r:e}:t)},setLeft:function(){return i(e)},setRight:function(){return i(r)}}}),[e,t])]},w=function(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a};function O(e){void 0===e&&(e=!1);var t=w(S(e),2),r=t[0],n=t[1].toggle;return[r,(0,f.useMemo)((function(){return{toggle:n,setTrue:function(){return n(!0)},setFalse:function(){return n(!1)}}}),[n])]}var M=r(1163),U=r(9352),j=r(4970),x=r.n(j),k=r(6483);function C(e){var t=e.size,r=void 0===t?256:t,i=function(){var e=u(O(!1),2),t=e[0],r=e[1].setTrue,n=u(O(!1),2),i=n[0],o=n[1].setTrue,a=(0,f.useState)(""),s=a[0],c=a[1],l=(0,f.useCallback)((function(){return c("")}),[c]),d=(0,f.useRef)(null),h=(0,f.useCallback)((function(){var e,t;c(null!==(e=null===(t=d.current)||void 0===t?void 0:t.getScreenshot())&&void 0!==e?e:"")}),[d,c]);return{ref:d,image:s,reset:l,capture:h,isCameraError:i,isCameraOnline:t,setCameraOnline:r,setCameraError:o}}(),a=i.ref,c=i.image,l=i.reset,d=i.capture,h=i.setCameraError,v=i.setCameraOnline,b=(0,M.useRouter)(),S=(0,f.useCallback)(s(o().mark((function e(){var t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.b.post("/adoro",{image:c});case 2:t=e.sent,r=t.data,console.log(r),b.push({pathname:"/time-machine",query:r});case 6:case"end":return e.stop()}}),e)}))),[b,c]);return(0,n.jsxs)(m.gC,{alignItems:"stretch",spacing:3,p:3,bg:"white",rounded:"md",boxShadow:"md",children:[(0,n.jsxs)(g.xu,{w:r,h:r,rounded:"lg",overflow:"hidden",children:[c&&(0,n.jsx)(y.E,{src:c,htmlHeight:r,htmlWidth:r,alt:"Your beautiful face"}),(0,n.jsx)(x(),{style:{display:c?"none":"block"},mirrored:!0,height:r,width:r,videoConstraints:{facingMode:"user",width:r,height:r},ref:a,screenshotQuality:1,screenshotFormat:"image/png",onUserMedia:v,onUserMediaError:h})]}),c?(0,n.jsxs)(m.Ug,{children:[(0,n.jsx)(p,{p:4,size:"xl",rounded:"lg",fontSize:"2rem",variant:"outline",onClick:l,"aria-label":"Retake photo",icon:(0,n.jsx)(U.qZq,{})}),(0,n.jsx)(p,{p:4,flex:1,size:"xl",icon:(0,n.jsx)(U.gF1,{}),colorScheme:"yellow",color:"white",rounded:"lg",fontSize:"2rem","aria-label":"Sing!",onClick:S})]}):(0,n.jsx)(p,{flex:1,p:4,size:"xl",color:"white",colorScheme:"yellow",variant:"solid",rounded:"lg",fontSize:"2rem",onClick:d,"aria-label":"Take photo",icon:(0,n.jsx)(U.Vpw,{})})]})}},6483:function(e,t,r){"use strict";r.d(t,{v:function(){return i},b:function(){return o}});var n=r(9669),i="",o=r.n(n)().create({baseURL:i})},5301:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(8344)}])},4970:function(e,t,r){var n;n=function(e){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./src/react-webcam.tsx")}({"./src/react-webcam.tsx":function(e,t,r){"use strict";r.r(t);var n=r("react"),i=function(){var e=function(t,r){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(t,r)};return function(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),o=function(){return(o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var i in t=arguments[r])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},a=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r};function s(){return!(!navigator.mediaDevices||!navigator.mediaDevices.getUserMedia)}"undefined"!==typeof window&&(void 0===navigator.mediaDevices&&(navigator.mediaDevices={}),void 0===navigator.mediaDevices.getUserMedia&&(navigator.mediaDevices.getUserMedia=function(e){var t=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia;return t?new Promise((function(r,n){t.call(navigator,e,r,n)})):Promise.reject(new Error("getUserMedia is not implemented in this browser"))}));var c=function(e){function t(t){var r=e.call(this,t)||this;return r.canvas=null,r.ctx=null,r.unmounted=!1,r.state={hasUserMedia:!1},r}return i(t,e),t.prototype.componentDidMount=function(){var e=this.state,t=this.props;s()?e.hasUserMedia||this.requestUserMedia():t.onUserMediaError("getUserMedia not supported")},t.prototype.componentDidUpdate=function(e){var t=this.props;if(s()){var r=JSON.stringify(e.audioConstraints)!==JSON.stringify(t.audioConstraints),n=JSON.stringify(e.videoConstraints)!==JSON.stringify(t.videoConstraints),i=e.minScreenshotWidth!==t.minScreenshotWidth,o=e.minScreenshotHeight!==t.minScreenshotHeight;(n||i||o)&&(this.canvas=null,this.ctx=null),(r||n)&&(this.stopAndCleanup(),this.requestUserMedia())}else t.onUserMediaError("getUserMedia not supported")},t.prototype.componentWillUnmount=function(){this.unmounted=!0,this.stopAndCleanup()},t.stopMediaStream=function(e){e&&(e.getVideoTracks&&e.getAudioTracks?(e.getVideoTracks().map((function(t){e.removeTrack(t),t.stop()})),e.getAudioTracks().map((function(t){e.removeTrack(t),t.stop()}))):e.stop())},t.prototype.stopAndCleanup=function(){var e=this.state;e.hasUserMedia&&(t.stopMediaStream(this.stream),e.src&&window.URL.revokeObjectURL(e.src))},t.prototype.getScreenshot=function(e){var t=this.state,r=this.props;if(!t.hasUserMedia)return null;var n=this.getCanvas(e);return n&&n.toDataURL(r.screenshotFormat,r.screenshotQuality)},t.prototype.getCanvas=function(e){var t=this.state,r=this.props;if(!this.video)return null;if(!t.hasUserMedia||!this.video.videoHeight)return null;if(!this.ctx){var n=this.video.videoWidth,i=this.video.videoHeight;if(!this.props.forceScreenshotSourceSize){var o=n/i;i=(n=r.minScreenshotWidth||this.video.clientWidth)/o,r.minScreenshotHeight&&i<r.minScreenshotHeight&&(n=(i=r.minScreenshotHeight)*o)}this.canvas=document.createElement("canvas"),this.canvas.width=(null===e||void 0===e?void 0:e.width)||n,this.canvas.height=(null===e||void 0===e?void 0:e.height)||i,this.ctx=this.canvas.getContext("2d")}var a=this.ctx,s=this.canvas;return a&&s&&(r.mirrored&&(a.translate(s.width,0),a.scale(-1,1)),a.imageSmoothingEnabled=r.imageSmoothing,a.drawImage(this.video,0,0,(null===e||void 0===e?void 0:e.width)||s.width,(null===e||void 0===e?void 0:e.height)||s.height),r.mirrored&&(a.scale(-1,1),a.translate(-s.width,0))),s},t.prototype.requestUserMedia=function(){var e=this,r=this.props,n=function(n,i){var o={video:"undefined"===typeof i||i};r.audio&&(o.audio="undefined"===typeof n||n),navigator.mediaDevices.getUserMedia(o).then((function(r){e.unmounted?t.stopMediaStream(r):e.handleUserMedia(null,r)})).catch((function(t){e.handleUserMedia(t)}))};if("mediaDevices"in navigator)n(r.audioConstraints,r.videoConstraints);else{var i=function(e){return{optional:[{sourceId:e}]}},o=function(e){var t=e.deviceId;return"string"===typeof t?t:Array.isArray(t)&&t.length>0?t[0]:"object"===typeof t&&t.ideal?t.ideal:null};MediaStreamTrack.getSources((function(e){var t=null,a=null;e.forEach((function(e){"audio"===e.kind?t=e.id:"video"===e.kind&&(a=e.id)}));var s=o(r.audioConstraints);s&&(t=s);var c=o(r.videoConstraints);c&&(a=c),n(i(t),i(a))}))}},t.prototype.handleUserMedia=function(e,t){var r=this.props;if(e||!t)return this.setState({hasUserMedia:!1}),void r.onUserMediaError(e);this.stream=t;try{this.video&&(this.video.srcObject=t),this.setState({hasUserMedia:!0})}catch(n){this.setState({hasUserMedia:!0,src:window.URL.createObjectURL(t)})}r.onUserMedia(t)},t.prototype.render=function(){var e=this,t=this.state,r=this.props,i=r.audio,s=(r.forceScreenshotSourceSize,r.onUserMedia,r.onUserMediaError,r.screenshotFormat,r.screenshotQuality,r.minScreenshotWidth,r.minScreenshotHeight,r.audioConstraints,r.videoConstraints,r.imageSmoothing,r.mirrored),c=r.style,u=void 0===c?{}:c,l=a(r,["audio","forceScreenshotSourceSize","onUserMedia","onUserMediaError","screenshotFormat","screenshotQuality","minScreenshotWidth","minScreenshotHeight","audioConstraints","videoConstraints","imageSmoothing","mirrored","style"]),d=s?o(o({},u),{transform:(u.transform||"")+" scaleX(-1)"}):u;return n.createElement("video",o({autoPlay:!0,src:t.src,muted:!i,playsInline:!0,ref:function(t){e.video=t},style:d},l))},t.defaultProps={audio:!1,forceScreenshotSourceSize:!1,imageSmoothing:!0,mirrored:!1,onUserMedia:function(){},onUserMediaError:function(){},screenshotFormat:"image/webp",screenshotQuality:.92},t}(n.Component);t.default=c},react:function(t,r){t.exports=e}}).default},e.exports=n(r(7294))}},function(e){e.O(0,[937,9,458,774,888,179],(function(){return t=5301,e(e.s=t);var t}));var t=e.O();_N_E=t}]);